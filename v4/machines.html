<!DOCTYPE html PUBLIC"-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">

<html>
	<head>
		<link rel="stylesheet" type="text/css" href="css/machines.css">
		<title>rube goldberg machine</title>
	</head>
	
	<body>

		<div id="options_div" class="top-level-div">
			<table id='options_table'>
				<tr>
					<td>
						<button class="option_button" id="message_button" title="">show message box</button>

						<button class="option_button" id="pause_button" title="pause/resume game ticker">pause</button>
						<button class="option_button" id="save_button" title="save game state">save</button>
						<button class="option_button" id="clear_button" title="clear messages">clear messages</button>
						<button class="option_button" id="export_button" title="export serialized game state to messages">export</button>
						<button class="option_button" id="load_button" title="load serialized game state from messages">load</button>
						<button class="option_button" id="export_json_button" title="show game state JSON">JSON</button>
						<button class="option_button" id="stats" title="show game stats">stats</button>
						<button class="option_button" id="reset_button" title="reset game">reset game</button>
						<button class="option_button" id="hard_reset" title="blow away local storage">hard reset</button>
						<!--br>
						Slider
						<input type="range" id='tick_rate_slider' min="100" value="100" max="5000" step="100"></input-->
					</td>
				</tr>
				<tr><td><div id="message-wrapper" class="top-level-div" data-visible="false"></div></td></tr>
			</table>
		</div>

		<div id='header_div' data-visible="true" class="">header content here</div>

		<div id="tab_bar_div" data-visible="true" class="">tab bar content here</div>

		<div id="machines_div" data-visible="true" class="pmm-collection"></div>

		<div id='footer_div' data-visible="true" class="">footer content here</div>
	</body>
</html>

<script src="//cdnjs.cloudflare.com/ajax/libs/numeral.js/1.5.3/numeral.min.js"></script>
<script type="text/javascript" src="../common/util.js"></script>
<script type="text/javascript" src="../common/state.js"></script>
<script type="text/javascript" src="../common/timer.js"></script>
<script type="text/javascript" src="../common/messages.js"></script>

<script type="text/javascript" src="js/def.js"></script>
<script type="text/javascript" src="js/fcns.js"></script>

<script type="text/javascript" src="js/init.js"></script>
<script type="text/javascript" src="js/events.js"></script>

<script>
var loaded_state = getFromLocalStorage(app.NAME);
var app;
if (loaded_state===null)
	app = new App();
else {
	var app = extend(new App(), loaded_state);
	for (var i=0; i<app.pmm_defs.length; i++){
		var p = app.pmm_defs[i];
		app.pmm_defs[i] = extend(new PerpetualMotionMachine(p.id, p.items), p);
	}
}

// from init.js
buildUI();

startTimers();

updateUI();

</script>
